BHU_dynamic_modifiers_setup = {
	add_dynamic_modifier = { modifier = BHU_leap_forward_dynamic_modifier }
	set_variable = { BHU_gdp_growth_modifier = 0.00 }
	set_variable = { BHU_production_units_to_GDP_ratio_modifier = 0.000 }
	set_variable = { Meter_garrison_bar_supply_value = 50 }
	set_variable = { Meter_garrison_bar_morale_value = 50 }
	set_variable = { convoy_supply_arrival = 10 }
	BHU_add_garrison_var = yes
}
BHU_convoy_supply_change = {
	add_to_variable = { convoy_supply_arrival = convoy_supply_arrival_temp }
	if = {
		limit = {
			check_variable = {
				convoy_supply_arrival_temp < 0
			}
		}
		multiply_temp_variable = { convoy_supply_arrival_temp = -1 }
		custom_effect_tooltip = BHU_convoy_supply_change_decrease_tt
	}
	else = { custom_effect_tooltip = BHU_convoy_supply_change_increase_tt }
	clamp_variable = {
		var = convoy_supply_arrival
		min = 0
		max = 100
	}
}
BHU_garrison_morale_monthly_change= {
	if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_supply_value < 20
			}
		}
		set_temp_variable = { Meter_garrison_bar_morale_temp = -10 }
	}
	else_if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_supply_value < 40
			}
		}
		set_temp_variable = { Meter_garrison_bar_morale_temp = -5 }
	}
	else_if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_supply_value < 60
			}
		}
		set_temp_variable = { Meter_garrison_bar_morale_temp = 5 }
	}
	else_if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_supply_value < 80
			}
		}
		set_temp_variable = { Meter_garrison_bar_morale_temp = 10 }
	}
	else = {
		set_temp_variable = { Meter_garrison_bar_morale_temp = 15 }
	}
}
BHU_garrison_supply_change = {
	add_to_variable = { Meter_garrison_bar_supply_value = Meter_garrison_bar_supply_temp }
	if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_supply_temp < 0
			}
		}
		multiply_temp_variable = { Meter_garrison_bar_supply_temp = -1 }
		custom_effect_tooltip = BHU_garrison_supply_change_decrease_tt
	}
	else = { custom_effect_tooltip = BHU_garrison_supply_change_increase_tt }
	BHU_add_garrison_var = yes
}
BHU_garrison_morale_change = {
	add_to_variable = { Meter_garrison_bar_morale_value = Meter_garrison_bar_morale_temp }
	if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_morale_temp < 0
			}
		}
		multiply_temp_variable = { Meter_garrison_bar_morale_temp = -1 }
		custom_effect_tooltip = BHU_garrison_morale_change_decrease_tt
	}
	else = { custom_effect_tooltip = BHU_garrison_morale_change_increase_tt }
	BHU_add_garrison_var = yes
}
BHU_economy_status_change = {
	add_to_variable = { BHU_gdp_growth_modifier = BHU_gdp_growth_modifier_temp }
	add_to_variable = { BHU_production_units_to_GDP_ratio_modifier = BHU_production_units_to_GDP_ratio_modifier_temp }
	if = {
		limit = {
			check_variable = {
				BHU_gdp_growth_modifier_temp < 0
			}
		}
		multiply_temp_variable = { BHU_gdp_growth_modifier_temp = -1 }
		custom_effect_tooltip = BHU_economy_status_change_decrease_tt
	}
	else = { custom_effect_tooltip = BHU_economy_status_change_increase_tt }
	BHU_add_garrison_var = yes
}
BHU_add_garrison_var= {
	clamp_variable = {
		var = Meter_garrison_bar_supply_value
		min = 0
		max = 100
	}
	clamp_variable = {
		var = Meter_garrison_bar_morale_value
		min = 0
		max = 100
	}
	set_variable = { Meter_garrison_bar_value = Meter_garrison_bar_supply_value }
	add_to_variable = { Meter_garrison_bar_value = Meter_garrison_bar_morale_value }
	divide_variable = { Meter_garrison_bar_value = 2 }
	clamp_variable = {
		var = Meter_garrison_bar_value
		min = 0
		max = 100
	}
	add_to_variable = { BHU_garrison_dirty_variable = 0.01 }
}	
BHU_calculate_garrison= {
	
	
	if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_value < 20
			}
		}
		set_temp_variable = { BHU_garrison_strength_var_temp = 0 }
	}
	else_if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_value < 40
			}
		}
		set_temp_variable = { BHU_garrison_strength_var_temp = 1 }
	}
	else_if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_value < 60
			}
		}
		set_temp_variable = { BHU_garrison_strength_var_temp = 2 }
	}
	else_if = {
		limit = {
			check_variable = {
				Meter_garrison_bar_value < 80
			}
		}
		set_temp_variable = { BHU_garrison_strength_var_temp = 3 }
	}
	else = {
		set_temp_variable = { BHU_garrison_strength_var_temp = 4 }
	}
	BHU_update_garrison = yes
}
BHU_update_garrison = {
	set_variable = { BHU_garrison_strength_var = BHU_garrison_strength_var_temp }
	hidden_effect = {
		remove_ideas = {
			BHU_INA_0
			BHU_INA_1
			BHU_INA_2
			BHU_INA_3
			BHU_INA_4
		}
		if = {
			limit = {
				check_variable = {
					BHU_garrison_strength_var = 4
				}
			}
			add_ideas = BHU_INA_4
		}
		else_if = {
			limit = {
				check_variable = {
					BHU_garrison_strength_var = 3
				}
			}
			add_ideas = BHU_INA_3
			
		}
		else_if = {
			limit = {
				check_variable = {
					BHU_garrison_strength_var = 2
				}
			}
			add_ideas = BHU_INA_2
			
		}
		else_if = {
			limit = {
				check_variable = {
					BHU_garrison_strength_var = 1
				}
			}
			add_ideas = BHU_INA_1
			
		}
		else = {
			add_ideas = BHU_INA_0
		}
	}
	add_to_variable = { BHU_garrison_dirty_variable = 0.01 }
}
bhutan_war_gov_win = { #doesn't trigger in game right now
	log = "[GetDateText]: [Root.GetTag]: bhutan_war_gov_win; Executing." # bhutanwar end
	
	BHU = {
		every_owned_state = {
			remove_core_of = FBH
		}
		AZH = {
			add_to_faction = BHU
		}
	}
}
bhutan_war_wang_win = { #doesn't trigger in game right now
	log = "[GetDateText]: [Root.GetTag]: bhutan_war_wang_win; Executing." # bhutanwar end
	
	FBH = {
		drop_cosmetic_tag = yes
		remove_ideas = {
			FBH_our_last_chance
		}
		every_owned_state = {
			remove_core_of = BHU
		}
		set_popularities = {
			communist = 3
			socialist = 8
			progressivism = 5
			conservatism = 15
			paternalism = 45
			despotism = 24
		}
	}
}
###Economic Meeting shenanigan

BHU_update_meeting_var = {
	set_temp_variable = { total = BHU_meeting_success_var }
	add_to_temp_variable = { total = BHU_meeting_failure_var }
	divide_temp_variable = { total = 100 }

	divide_variable = { BHU_meeting_success_var = total }
	divide_variable = { BHU_meeting_failure_var = total }

	
}

# +9 suc
BHU_success_chance_increase_high = {
	

	add_to_variable = { BHU_meeting_success_var = 9 }
	BHU_update_meeting_var = yes
}

# +5 suc
BHU_success_chance_increase_med = {
	

	add_to_variable = { BHU_meeting_success_var = 5 }
	BHU_update_meeting_var = yes
}

# +9fail
BHU_failure_chance_increase_high = {


	add_to_variable = { BHU_meeting_failure_var = 9 }
	BHU_update_meeting_var = yes
}

# +5 fail
BHU_failure_chance_increase_med = {


	add_to_variable = { BHU_meeting_failure_var = 5 }
	BHU_update_meeting_var = yes
}
